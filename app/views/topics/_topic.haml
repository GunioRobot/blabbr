%ul.topic-list
  - if can? :update, @topic
    %li#add-member
      = form_tag add_member_topic_path(@topic), :method => 'put' do
        = text_field_tag :nickname, params[:nickname], 'data-autocomplete-url' => autocomplete_users_path, :class => 'autocomplete'
        = submit_tag t('member.add')
    %li.edit
      = link_to t('topics.edit'), edit_topic_path(topic)
    %li.destroy
      = link_to t('topics.destroy'), topic, :confirm => 'Are you sure ?', :method => :delete
  %li#ratio
    %ul
      %li#posts-ratio
        = link_to post_ratio(topic), topic_path(topic)
      %li#members
        = link_to topic.members.size, topic_path(topic)
      %li#files-ratio
        = link_to attachments_ratio(topic), topic_path(topic)
%hr
- if can? :update, @topic
  %strong
    = t('subscriber').pluralize
    - members_without_creator(topic).each do |member|
      = form_tag rm_member_topic_path, :method => :put do
        = member.nickname
        = hidden_field_tag :nickname, member.nickname
        = submit_tag t('members.delete')
= paginate @posts, :params => { :format => nil }
%section#posts{:class => 'page-title', :title => topic.title}
  = render :partial => 'posts/post', :collection => @posts, :locals => {:topic => topic}
= paginate @posts, :params => { :format => nil }
= form_for([topic, Post.new], :url => topic_posts_path(topic), :remote => true ) do |form|
  = render :partial => 'posts/form', :locals => {:form => form}
